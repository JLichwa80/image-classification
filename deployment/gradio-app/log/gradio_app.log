2025-12-07 15:34:16,917 - __main__ - INFO - Content directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\content
2025-12-07 15:34:16,918 - __main__ - INFO - Counter file: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\data\total_images_processed.txt
2025-12-07 15:34:16,918 - __main__ - INFO - Log directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\log
2025-12-07 15:34:16,918 - __main__ - INFO - Initializing global counter...
2025-12-07 15:34:16,919 - __main__ - INFO - Loaded total images processed: 0
2025-12-07 15:34:16,919 - __main__ - INFO - ============================================================
2025-12-07 15:34:16,919 - __main__ - INFO - Starting model loading...
2025-12-07 15:34:16,919 - __main__ - INFO - ============================================================
2025-12-07 15:34:16,919 - __main__ - INFO - Loading Stage 1 model: models/set2_pneumonia_detector.pkl
2025-12-07 15:34:16,977 - __main__ - INFO - [SUCCESS] Stage 1 model loaded successfully
2025-12-07 15:34:16,977 - __main__ - INFO - Loading Stage 2 model: models/set2_stage2_bacterial_viral_detector.pkl
2025-12-07 15:34:17,050 - __main__ - INFO - [SUCCESS] Stage 2 model loaded successfully
2025-12-07 15:34:17,051 - __main__ - INFO - ============================================================
2025-12-07 15:34:17,051 - __main__ - INFO - All models loaded successfully!
2025-12-07 15:34:17,051 - __main__ - INFO - ============================================================
2025-12-07 15:34:17,051 - __main__ - INFO - Extracting CLAHE configuration from model...
2025-12-07 15:34:17,051 - __main__ - WARNING - CLAHE configuration not found in model, using defaults
2025-12-07 15:34:17,051 - __main__ - INFO - CLAHE Settings: {'clipLimit': 2.0, 'tileGridSize': (8, 8), 'colormap': 'COLORMAP_HOT'}
2025-12-07 15:34:17,075 - __main__ - INFO - Running model pipeline...
2025-12-07 15:34:17,978 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:34:17,985 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:34:17,991 - __main__ - WARNING - Failed to prepare single example preview: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:34:18,021 - __main__ - INFO - Running model pipeline...
2025-12-07 15:34:19,110 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:34:19,115 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:34:19,119 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_01.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:34:19,140 - __main__ - INFO - Running model pipeline...
2025-12-07 15:34:19,803 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:34:19,807 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:34:19,810 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_02.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:34:19,831 - __main__ - INFO - Running model pipeline...
2025-12-07 15:34:20,649 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:34:20,655 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:34:20,658 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_03.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:34:20,660 - __main__ - INFO - ============================================================
2025-12-07 15:34:20,660 - __main__ - INFO - Building default Gradio interface (full app)...
2025-12-07 15:34:20,661 - __main__ - INFO - ============================================================
2025-12-07 15:34:20,661 - __main__ - INFO - Static paths configured: assets/, examples/
2025-12-07 15:34:20,662 - __main__ - INFO - Building full multi-tab app...
2025-12-07 15:34:20,791 - __main__ - INFO - Full multi-tab app built
2025-12-07 15:34:20,792 - __main__ - INFO - Gradio interface created successfully
2025-12-07 15:34:20,792 - __main__ - INFO - ============================================================
2025-12-07 15:34:20,792 - __main__ - INFO - LAUNCHING GRADIO APP
2025-12-07 15:34:20,792 - __main__ - INFO - ============================================================
2025-12-07 15:34:20,793 - __main__ - INFO - Serving static files from: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples, C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\assets
2025-12-07 15:34:21,112 - httpx - INFO - HTTP Request: GET http://127.0.0.1:7860/gradio_api/startup-events "HTTP/1.1 200 OK"
2025-12-07 15:34:21,142 - httpx - INFO - HTTP Request: HEAD http://127.0.0.1:7860/ "HTTP/1.1 200 OK"
2025-12-07 15:34:21,247 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-initiated-analytics "HTTP/1.1 200 OK"
2025-12-07 15:34:21,261 - httpx - INFO - HTTP Request: GET https://api.gradio.app/pkg-version "HTTP/1.1 200 OK"
2025-12-07 15:34:21,409 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-launched-telemetry "HTTP/1.1 200 OK"
2025-12-07 15:36:16,936 - app - INFO - Content directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\content
2025-12-07 15:36:16,936 - app - INFO - Counter file: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\data\total_images_processed.txt
2025-12-07 15:36:16,937 - app - INFO - Log directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\log
2025-12-07 15:36:16,937 - app - INFO - Initializing global counter...
2025-12-07 15:36:16,937 - app - INFO - Loaded total images processed: 0
2025-12-07 15:36:16,937 - app - INFO - ============================================================
2025-12-07 15:36:16,937 - app - INFO - Starting model loading...
2025-12-07 15:36:16,937 - app - INFO - ============================================================
2025-12-07 15:36:16,937 - app - INFO - Loading Stage 1 model: models/set2_pneumonia_detector.pkl
2025-12-07 15:36:16,997 - app - INFO - [SUCCESS] Stage 1 model loaded successfully
2025-12-07 15:36:16,997 - app - INFO - Loading Stage 2 model: models/set2_stage2_bacterial_viral_detector.pkl
2025-12-07 15:36:17,053 - app - INFO - [SUCCESS] Stage 2 model loaded successfully
2025-12-07 15:36:17,053 - app - INFO - ============================================================
2025-12-07 15:36:17,054 - app - INFO - All models loaded successfully!
2025-12-07 15:36:17,054 - app - INFO - ============================================================
2025-12-07 15:36:17,054 - app - INFO - Extracting CLAHE configuration from model...
2025-12-07 15:36:17,054 - app - WARNING - CLAHE configuration not found in model, using defaults
2025-12-07 15:36:17,054 - app - INFO - CLAHE Settings: {'clipLimit': 2.0, 'tileGridSize': (8, 8), 'colormap': 'COLORMAP_HOT'}
2025-12-07 15:36:17,085 - app - INFO - Running model pipeline...
2025-12-07 15:36:18,088 - app - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:36:18,095 - app - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:36:18,101 - app - WARNING - Failed to prepare single example preview: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:36:18,126 - app - INFO - Running model pipeline...
2025-12-07 15:36:19,201 - app - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:36:19,205 - app - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:36:19,209 - app - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_01.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:36:19,227 - app - INFO - Running model pipeline...
2025-12-07 15:36:19,905 - app - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:36:19,910 - app - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:36:19,912 - app - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_02.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:36:19,932 - app - INFO - Running model pipeline...
2025-12-07 15:36:20,760 - app - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:36:20,765 - app - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:36:20,768 - app - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_03.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:36:20,771 - app - INFO - ============================================================
2025-12-07 15:36:20,771 - app - INFO - Building default Gradio interface (full app)...
2025-12-07 15:36:20,771 - app - INFO - ============================================================
2025-12-07 15:36:20,771 - app - INFO - Static paths configured: assets/, examples/
2025-12-07 15:36:20,772 - app - INFO - Building full multi-tab app...
2025-12-07 15:36:20,908 - app - INFO - Full multi-tab app built
2025-12-07 15:36:20,908 - app - INFO - Gradio interface created successfully
2025-12-07 15:36:20,909 - app - INFO - Building Single Image Analysis app...
2025-12-07 15:36:21,029 - app - INFO - Single Image Analysis app built
2025-12-07 15:36:21,029 - app - INFO - Building Batch Analysis app...
2025-12-07 15:36:21,234 - app - INFO - Batch Analysis app built
2025-12-07 15:36:21,234 - app - INFO - Building About app...
2025-12-07 15:36:21,352 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-initiated-analytics "HTTP/1.1 200 OK"
2025-12-07 15:36:21,374 - app - INFO - About app built
2025-12-07 15:36:21,375 - httpx - INFO - HTTP Request: GET https://api.gradio.app/pkg-version "HTTP/1.1 200 OK"
2025-12-07 15:36:21,828 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-initiated-analytics "HTTP/1.1 200 OK"
2025-12-07 15:36:21,902 - httpx - INFO - HTTP Request: GET https://api.gradio.app/pkg-version "HTTP/1.1 200 OK"
2025-12-07 15:36:21,993 - httpx - INFO - HTTP Request: GET https://api.gradio.app/pkg-version "HTTP/1.1 200 OK"
2025-12-07 15:36:22,003 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-initiated-analytics "HTTP/1.1 200 OK"
2025-12-07 15:36:22,020 - httpx - INFO - HTTP Request: GET https://api.gradio.app/pkg-version "HTTP/1.1 200 OK"
2025-12-07 15:36:22,222 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-initiated-analytics "HTTP/1.1 200 OK"
2025-12-07 15:46:27,079 - __main__ - INFO - Content directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\content
2025-12-07 15:46:27,079 - __main__ - INFO - Counter file: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\data\total_images_processed.txt
2025-12-07 15:46:27,080 - __main__ - INFO - Log directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\log
2025-12-07 15:46:27,080 - __main__ - INFO - Initializing global counter...
2025-12-07 15:46:27,080 - __main__ - INFO - Loaded total images processed: 0
2025-12-07 15:46:27,081 - __main__ - INFO - ============================================================
2025-12-07 15:46:27,081 - __main__ - INFO - Starting model loading...
2025-12-07 15:46:27,081 - __main__ - INFO - ============================================================
2025-12-07 15:46:27,081 - __main__ - INFO - Loading Stage 1 model: models/set2_pneumonia_detector.pkl
2025-12-07 15:46:27,170 - __main__ - INFO - [SUCCESS] Stage 1 model loaded successfully
2025-12-07 15:46:27,170 - __main__ - INFO - Loading Stage 2 model: models/set2_stage2_bacterial_viral_detector.pkl
2025-12-07 15:46:27,256 - __main__ - INFO - [SUCCESS] Stage 2 model loaded successfully
2025-12-07 15:46:27,256 - __main__ - INFO - ============================================================
2025-12-07 15:46:27,256 - __main__ - INFO - All models loaded successfully!
2025-12-07 15:46:27,257 - __main__ - INFO - ============================================================
2025-12-07 15:46:27,257 - __main__ - INFO - Extracting CLAHE configuration from model...
2025-12-07 15:46:27,257 - __main__ - WARNING - CLAHE configuration not found in model, using defaults
2025-12-07 15:46:27,257 - __main__ - INFO - CLAHE Settings: {'clipLimit': 2.0, 'tileGridSize': (8, 8), 'colormap': 'COLORMAP_HOT'}
2025-12-07 15:46:27,296 - __main__ - INFO - Running model pipeline...
2025-12-07 15:46:28,974 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:46:28,984 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:46:28,993 - __main__ - WARNING - Failed to prepare single example preview: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:46:29,035 - __main__ - INFO - Running model pipeline...
2025-12-07 15:46:30,722 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:46:30,727 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:46:30,730 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_01.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:46:30,760 - __main__ - INFO - Running model pipeline...
2025-12-07 15:46:31,756 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:46:31,762 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:46:31,766 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_02.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:46:31,799 - __main__ - INFO - Running model pipeline...
2025-12-07 15:46:33,126 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:46:33,132 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:46:33,136 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_03.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:46:33,138 - __main__ - INFO - ============================================================
2025-12-07 15:46:33,138 - __main__ - INFO - Building Gradio interface...
2025-12-07 15:46:33,138 - __main__ - INFO - ============================================================
2025-12-07 15:46:33,139 - __main__ - INFO - Static paths configured: assets/, examples/
2025-12-07 15:46:33,387 - __main__ - INFO - Gradio interface created successfully
2025-12-07 15:46:33,387 - __main__ - INFO - ============================================================
2025-12-07 15:46:33,388 - __main__ - INFO - LAUNCHING GRADIO APP
2025-12-07 15:46:33,388 - __main__ - INFO - ============================================================
2025-12-07 15:46:33,388 - __main__ - INFO - Serving static files from: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples, C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\assets
2025-12-07 15:46:33,802 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-initiated-analytics "HTTP/1.1 200 OK"
2025-12-07 15:46:33,874 - httpx - INFO - HTTP Request: GET http://127.0.0.1:7860/gradio_api/startup-events "HTTP/1.1 200 OK"
2025-12-07 15:46:33,901 - httpx - INFO - HTTP Request: GET https://api.gradio.app/pkg-version "HTTP/1.1 200 OK"
2025-12-07 15:46:33,902 - httpx - INFO - HTTP Request: HEAD http://127.0.0.1:7860/ "HTTP/1.1 200 OK"
2025-12-07 15:46:33,999 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-launched-telemetry "HTTP/1.1 200 OK"
2025-12-07 15:53:28,230 - __main__ - INFO - Content directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\content
2025-12-07 15:53:28,230 - __main__ - INFO - Counter file: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\data\total_images_processed.txt
2025-12-07 15:53:28,230 - __main__ - INFO - Log directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\log
2025-12-07 15:53:28,231 - __main__ - INFO - Initializing global counter...
2025-12-07 15:53:28,231 - __main__ - INFO - Loaded total images processed: 0
2025-12-07 15:53:28,231 - __main__ - INFO - ============================================================
2025-12-07 15:53:28,231 - __main__ - INFO - Starting model loading...
2025-12-07 15:53:28,232 - __main__ - INFO - ============================================================
2025-12-07 15:53:28,232 - __main__ - INFO - Loading Stage 1 model: models/set2_pneumonia_detector.pkl
2025-12-07 15:53:28,310 - __main__ - INFO - [SUCCESS] Stage 1 model loaded successfully
2025-12-07 15:53:28,311 - __main__ - INFO - Loading Stage 2 model: models/set2_stage2_bacterial_viral_detector.pkl
2025-12-07 15:53:28,388 - __main__ - INFO - [SUCCESS] Stage 2 model loaded successfully
2025-12-07 15:53:28,388 - __main__ - INFO - ============================================================
2025-12-07 15:53:28,389 - __main__ - INFO - All models loaded successfully!
2025-12-07 15:53:28,389 - __main__ - INFO - ============================================================
2025-12-07 15:53:28,389 - __main__ - INFO - Extracting CLAHE configuration from model...
2025-12-07 15:53:28,389 - __main__ - WARNING - CLAHE configuration not found in model, using defaults
2025-12-07 15:53:28,389 - __main__ - INFO - CLAHE Settings: {'clipLimit': 2.0, 'tileGridSize': (8, 8), 'colormap': 'COLORMAP_HOT'}
2025-12-07 15:53:28,435 - __main__ - INFO - Running model pipeline...
2025-12-07 15:53:29,953 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:53:29,966 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:53:29,975 - __main__ - WARNING - Failed to prepare single example preview: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:53:30,017 - __main__ - INFO - Running model pipeline...
2025-12-07 15:53:31,666 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:53:31,675 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:53:31,680 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_01.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:53:31,705 - __main__ - INFO - Running model pipeline...
2025-12-07 15:53:32,824 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:53:32,830 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:53:32,834 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_02.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:53:32,862 - __main__ - INFO - Running model pipeline...
2025-12-07 15:53:34,157 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:53:34,162 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:53:34,166 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_03.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:53:34,168 - __main__ - INFO - ============================================================
2025-12-07 15:53:34,168 - __main__ - INFO - Building Gradio interface...
2025-12-07 15:53:34,169 - __main__ - INFO - ============================================================
2025-12-07 15:53:34,170 - __main__ - INFO - Static paths configured: assets/, examples/
2025-12-07 15:53:34,422 - __main__ - INFO - Gradio interface created successfully
2025-12-07 15:53:34,422 - __main__ - INFO - ============================================================
2025-12-07 15:53:34,423 - __main__ - INFO - LAUNCHING GRADIO APP
2025-12-07 15:53:34,423 - __main__ - INFO - ============================================================
2025-12-07 15:53:34,423 - __main__ - INFO - Serving static files from: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples, C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\assets
2025-12-07 15:53:34,794 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-initiated-analytics "HTTP/1.1 200 OK"
2025-12-07 15:53:34,795 - httpx - INFO - HTTP Request: GET https://api.gradio.app/pkg-version "HTTP/1.1 200 OK"
2025-12-07 15:53:34,922 - httpx - INFO - HTTP Request: GET http://127.0.0.1:7860/gradio_api/startup-events "HTTP/1.1 200 OK"
2025-12-07 15:53:34,969 - httpx - INFO - HTTP Request: HEAD http://127.0.0.1:7860/ "HTTP/1.1 200 OK"
2025-12-07 15:53:35,072 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-launched-telemetry "HTTP/1.1 200 OK"
2025-12-07 15:55:20,704 - __main__ - INFO - Content directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\content
2025-12-07 15:55:20,705 - __main__ - INFO - Counter file: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\data\total_images_processed.txt
2025-12-07 15:55:20,705 - __main__ - INFO - Log directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\log
2025-12-07 15:55:20,705 - __main__ - INFO - Initializing global counter...
2025-12-07 15:55:20,705 - __main__ - INFO - Loaded total images processed: 0
2025-12-07 15:55:20,706 - __main__ - INFO - ============================================================
2025-12-07 15:55:20,706 - __main__ - INFO - Starting model loading...
2025-12-07 15:55:20,706 - __main__ - INFO - ============================================================
2025-12-07 15:55:20,706 - __main__ - INFO - Loading Stage 1 model: models/set2_pneumonia_detector.pkl
2025-12-07 15:55:20,793 - __main__ - INFO - [SUCCESS] Stage 1 model loaded successfully
2025-12-07 15:55:20,794 - __main__ - INFO - Loading Stage 2 model: models/set2_stage2_bacterial_viral_detector.pkl
2025-12-07 15:55:20,878 - __main__ - INFO - [SUCCESS] Stage 2 model loaded successfully
2025-12-07 15:55:20,879 - __main__ - INFO - ============================================================
2025-12-07 15:55:20,879 - __main__ - INFO - All models loaded successfully!
2025-12-07 15:55:20,879 - __main__ - INFO - ============================================================
2025-12-07 15:55:20,879 - __main__ - INFO - Extracting CLAHE configuration from model...
2025-12-07 15:55:20,879 - __main__ - WARNING - CLAHE configuration not found in model, using defaults
2025-12-07 15:55:20,880 - __main__ - INFO - CLAHE Settings: {'clipLimit': 2.0, 'tileGridSize': (8, 8), 'colormap': 'COLORMAP_HOT'}
2025-12-07 15:55:20,914 - __main__ - INFO - Running model pipeline...
2025-12-07 15:55:22,360 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:55:22,368 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:55:22,376 - __main__ - WARNING - Failed to prepare single example preview: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:55:22,415 - __main__ - INFO - Running model pipeline...
2025-12-07 15:55:24,269 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:55:24,274 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:55:24,278 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_01.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:55:24,305 - __main__ - INFO - Running model pipeline...
2025-12-07 15:55:25,335 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:55:25,341 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:55:25,345 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_02.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:55:25,378 - __main__ - INFO - Running model pipeline...
2025-12-07 15:55:26,632 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 15:55:26,638 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:55:26,643 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_03.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 15:55:26,646 - __main__ - INFO - ============================================================
2025-12-07 15:55:26,646 - __main__ - INFO - Building Gradio interface...
2025-12-07 15:55:26,647 - __main__ - INFO - ============================================================
2025-12-07 15:55:26,648 - __main__ - INFO - Static paths configured: assets/, examples/
2025-12-07 15:55:26,882 - __main__ - INFO - Gradio interface created successfully
2025-12-07 15:55:26,882 - __main__ - INFO - ============================================================
2025-12-07 15:55:26,883 - __main__ - INFO - LAUNCHING GRADIO APP
2025-12-07 15:55:26,883 - __main__ - INFO - ============================================================
2025-12-07 15:55:26,883 - __main__ - INFO - Serving static files from: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples, C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\assets
2025-12-07 15:55:27,297 - httpx - INFO - HTTP Request: GET https://api.gradio.app/pkg-version "HTTP/1.1 200 OK"
2025-12-07 15:55:27,304 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-initiated-analytics "HTTP/1.1 200 OK"
2025-12-07 15:55:27,354 - httpx - INFO - HTTP Request: GET http://127.0.0.1:7860/gradio_api/startup-events "HTTP/1.1 200 OK"
2025-12-07 15:55:27,385 - httpx - INFO - HTTP Request: HEAD http://127.0.0.1:7860/ "HTTP/1.1 200 OK"
2025-12-07 15:55:27,486 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-launched-telemetry "HTTP/1.1 200 OK"
2025-12-07 16:01:23,590 - __main__ - INFO - Content directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\content
2025-12-07 16:01:23,590 - __main__ - INFO - Counter file: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\data\total_images_processed.txt
2025-12-07 16:01:23,590 - __main__ - INFO - Log directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\log
2025-12-07 16:01:23,591 - __main__ - INFO - Initializing global counter...
2025-12-07 16:01:23,591 - __main__ - INFO - Loaded total images processed: 0
2025-12-07 16:01:23,591 - __main__ - INFO - ============================================================
2025-12-07 16:01:23,591 - __main__ - INFO - Starting model loading...
2025-12-07 16:01:23,592 - __main__ - INFO - ============================================================
2025-12-07 16:01:23,592 - __main__ - INFO - Loading Stage 1 model: models/set2_pneumonia_detector.pkl
2025-12-07 16:01:23,651 - __main__ - INFO - [SUCCESS] Stage 1 model loaded successfully
2025-12-07 16:01:23,652 - __main__ - INFO - Loading Stage 2 model: models/set2_stage2_bacterial_viral_detector.pkl
2025-12-07 16:01:23,715 - __main__ - INFO - [SUCCESS] Stage 2 model loaded successfully
2025-12-07 16:01:23,715 - __main__ - INFO - ============================================================
2025-12-07 16:01:23,715 - __main__ - INFO - All models loaded successfully!
2025-12-07 16:01:23,715 - __main__ - INFO - ============================================================
2025-12-07 16:01:23,716 - __main__ - INFO - Extracting CLAHE configuration from model...
2025-12-07 16:01:23,716 - __main__ - WARNING - CLAHE configuration not found in model, using defaults
2025-12-07 16:01:23,716 - __main__ - INFO - CLAHE Settings: {'clipLimit': 2.0, 'tileGridSize': (8, 8), 'colormap': 'COLORMAP_HOT'}
2025-12-07 16:01:23,743 - __main__ - INFO - Running model pipeline...
2025-12-07 16:01:24,710 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 16:01:24,718 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:01:24,724 - __main__ - WARNING - Failed to prepare single example preview: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:01:24,754 - __main__ - INFO - Running model pipeline...
2025-12-07 16:01:25,911 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 16:01:25,916 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:01:25,919 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_01.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:01:25,937 - __main__ - INFO - Running model pipeline...
2025-12-07 16:01:26,615 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 16:01:26,620 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:01:26,623 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_02.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:01:26,643 - __main__ - INFO - Running model pipeline...
2025-12-07 16:01:27,490 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 16:01:27,496 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:01:27,499 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_03.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:01:27,501 - __main__ - INFO - ============================================================
2025-12-07 16:01:27,502 - __main__ - INFO - Building Gradio interface...
2025-12-07 16:01:27,502 - __main__ - INFO - ============================================================
2025-12-07 16:01:27,503 - __main__ - INFO - Static paths configured: assets/, examples/
2025-12-07 16:01:27,681 - __main__ - INFO - Gradio interface created successfully
2025-12-07 16:01:27,681 - __main__ - INFO - ============================================================
2025-12-07 16:01:27,682 - __main__ - INFO - LAUNCHING GRADIO APP
2025-12-07 16:01:27,682 - __main__ - INFO - ============================================================
2025-12-07 16:01:27,682 - __main__ - INFO - Serving static files from: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples, C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\assets
2025-12-07 16:01:27,998 - httpx - INFO - HTTP Request: GET http://127.0.0.1:7860/gradio_api/startup-events "HTTP/1.1 200 OK"
2025-12-07 16:01:28,032 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-initiated-analytics "HTTP/1.1 200 OK"
2025-12-07 16:01:28,033 - httpx - INFO - HTTP Request: HEAD http://127.0.0.1:7860/ "HTTP/1.1 200 OK"
2025-12-07 16:01:28,127 - httpx - INFO - HTTP Request: GET https://api.gradio.app/pkg-version "HTTP/1.1 200 OK"
2025-12-07 16:01:28,145 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-launched-telemetry "HTTP/1.1 200 OK"
2025-12-07 16:05:15,959 - __main__ - INFO - Content directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\content
2025-12-07 16:05:15,960 - __main__ - INFO - Counter file: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\data\total_images_processed.txt
2025-12-07 16:05:15,960 - __main__ - INFO - Log directory: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\log
2025-12-07 16:05:15,960 - __main__ - INFO - Initializing global counter...
2025-12-07 16:05:15,960 - __main__ - INFO - Loaded total images processed: 0
2025-12-07 16:05:15,960 - __main__ - INFO - ============================================================
2025-12-07 16:05:15,960 - __main__ - INFO - Starting model loading...
2025-12-07 16:05:15,960 - __main__ - INFO - ============================================================
2025-12-07 16:05:15,961 - __main__ - INFO - Loading Stage 1 model: models/set2_pneumonia_detector.pkl
2025-12-07 16:05:16,012 - __main__ - INFO - [SUCCESS] Stage 1 model loaded successfully
2025-12-07 16:05:16,013 - __main__ - INFO - Loading Stage 2 model: models/set2_stage2_bacterial_viral_detector.pkl
2025-12-07 16:05:16,070 - __main__ - INFO - [SUCCESS] Stage 2 model loaded successfully
2025-12-07 16:05:16,071 - __main__ - INFO - ============================================================
2025-12-07 16:05:16,071 - __main__ - INFO - All models loaded successfully!
2025-12-07 16:05:16,071 - __main__ - INFO - ============================================================
2025-12-07 16:05:16,071 - __main__ - INFO - Extracting CLAHE configuration from model...
2025-12-07 16:05:16,071 - __main__ - WARNING - CLAHE configuration not found in model, using defaults
2025-12-07 16:05:16,071 - __main__ - INFO - CLAHE Settings: {'clipLimit': 2.0, 'tileGridSize': (8, 8), 'colormap': 'COLORMAP_HOT'}
2025-12-07 16:05:16,095 - __main__ - INFO - Running model pipeline...
2025-12-07 16:05:16,982 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 16:05:16,990 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:05:16,995 - __main__ - WARNING - Failed to prepare single example preview: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:05:17,020 - __main__ - INFO - Running model pipeline...
2025-12-07 16:05:18,043 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 16:05:18,047 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:05:18,050 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_01.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:05:18,070 - __main__ - INFO - Running model pipeline...
2025-12-07 16:05:18,696 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 16:05:18,700 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:05:18,703 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_02.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:05:18,724 - __main__ - INFO - Running model pipeline...
2025-12-07 16:05:19,477 - __main__ - INFO - Running Stage 1 prediction (Pneumonia Detection)...
2025-12-07 16:05:19,481 - __main__ - ERROR - Error in model pipeline: unsupported operand type(s) for +: 'Image' and 'dict'
Traceback (most recent call last):
  File "C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\app.py", line 278, in _run_model_pipeline
    pred1, idx1, probs1 = stage1_model.predict(pil_img)
                          ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 329, in predict
    inp,preds,_,dec_preds = self.get_preds(dl=dl, with_input=True, with_decoded=True)
                            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 316, in get_preds
    self._do_epoch_validate(dl=dl)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 252, in _do_epoch_validate
    with torch.no_grad(): self._with_events(self.all_batches, 'validate', CancelValidException)
                          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 207, in _with_events
    try: self(f'before_{event_type}');  f()
                                        ~^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\learner.py", line 213, in all_batches
    for o in enumerate(self.dl): self.one_batch(*o)
             ~~~~~~~~~^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 129, in __iter__
    for b in _loaders[self.fake_l.num_workers==0](self.fake_l):
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 732, in __next__
    data = self._next_data()
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Jack\anaconda3\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 140, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastcore\basics.py", line 265, in chunked
    res = list(itertools.islice(it, chunk_sz))
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 170, in do_item
    try: return self.after_item(self.create_item(s))
                                ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\load.py", line 177, in create_item
    if self.indexed: return self.dataset[s or 0]
                            ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 454, in __getitem__
    res = tuple([tl[it] for tl in self.tls])
                 ~~^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 413, in __getitem__
    return self._after_item(res) if is_indexer(idx) else res.map(self._after_item)
           ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fastai\data\core.py", line 373, in _after_item
    def _after_item(self, o): return self.tfms(o)
                                     ~~~~~~~~~^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 248, in __call__
    def __call__(self, o): return compose_tfms(o, tfms=self.fs, split_idx=self.split_idx)
                                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 197, in compose_tfms
    x = f(x, **kwargs)
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 114, in __call__
    def __call__(self,*args,split_idx=None, **kwargs): return self._call('encodes', *args, split_idx=split_idx, **kwargs)
                                                              ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 125, in _call
    return self._do_call(nm, *args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jack\anaconda3\Lib\site-packages\fasttransform\transform.py", line 136, in _do_call
    return retain_type(method(*f_args,**kwargs), x, ret_type)
                       ~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:05:19,484 - __main__ - WARNING - Skipping batch example C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples\covid_03.jpg: unsupported operand type(s) for +: 'Image' and 'dict'
2025-12-07 16:05:19,486 - __main__ - INFO - ============================================================
2025-12-07 16:05:19,486 - __main__ - INFO - Building Gradio interface...
2025-12-07 16:05:19,487 - __main__ - INFO - ============================================================
2025-12-07 16:05:19,487 - __main__ - INFO - Static paths configured: assets/, examples/
2025-12-07 16:05:19,619 - __main__ - INFO - Gradio interface created successfully
2025-12-07 16:05:19,619 - __main__ - INFO - ============================================================
2025-12-07 16:05:19,619 - __main__ - INFO - LAUNCHING GRADIO APP
2025-12-07 16:05:19,619 - __main__ - INFO - ============================================================
2025-12-07 16:05:19,620 - __main__ - INFO - Serving static files from: C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\examples, C:\Users\Jack\MyDriveSchool\SeattleU\5100-DataIntro\Projects\image-classification\deployment\gradio-app\assets
2025-12-07 16:05:19,911 - httpx - INFO - HTTP Request: GET http://127.0.0.1:7860/gradio_api/startup-events "HTTP/1.1 200 OK"
2025-12-07 16:05:19,931 - httpx - INFO - HTTP Request: HEAD http://127.0.0.1:7860/ "HTTP/1.1 200 OK"
2025-12-07 16:05:19,967 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-initiated-analytics "HTTP/1.1 200 OK"
2025-12-07 16:05:20,003 - httpx - INFO - HTTP Request: GET https://api.gradio.app/pkg-version "HTTP/1.1 200 OK"
2025-12-07 16:05:20,088 - httpx - INFO - HTTP Request: HEAD https://huggingface.co/api/telemetry/https%3A/api.gradio.app/gradio-launched-telemetry "HTTP/1.1 200 OK"
